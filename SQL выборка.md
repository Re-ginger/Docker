# Оптимизация и выборка данных из базы данных виноделия


## Запросы с использованием `JOIN`

### 1. Запрос с `INNER JOIN`
Этот запрос выполняет соединение (INNER JOIN) таблицы WineProduction с таблицей Vineyards по vineyard_id, чтобы получить информацию о типе вина и названии виноградника. Он полезен для получения данных о том, какое вино производится в каком винограднике.
```sql
SELECT wp.production_id, wp.wine_type, v.name AS vineyard_name FROM WineProduction wp INNER JOIN Vineyards v ON wp.vineyard_id = v.vineyard_id;
+---------------+-----------+------------------+
| production_id | wine_type | vineyard_name    |
+---------------+-----------+------------------+
|             1 | Red       | Example Vineyard |
+---------------+-----------+------------------+
1 row in set (0.00 sec)
```

### 2. Запрос с `LEFT JOIN`
 Этот запрос выполняет левое соединение (LEFT JOIN) таблицы Batches с таблицей WineProduction по production_id. Он позволяет получить все записи из таблицы Batches и соответствующий тип вина, если информация о производстве доступна. Если тип вина отсутствует, поле будет заполнено NULL. Это полезно для проверки, какие партии вина связаны с производством, даже если данные о производстве не полные.
```sql
SELECT b.batch_id, b.production_id, wp.wine_type FROM Batches b LEFT JOIN WineProduction wp ON b.production_id = wp.production_id;
+----------+---------------+-----------+
| batch_id | production_id | wine_type |
+----------+---------------+-----------+
|      101 |             1 | Red       |
|      102 |             2 | White     |
|      103 |             3 | Ros       |
|      102 |             2 | Red       |
|      103 |             3 | Red       |
+----------+---------------+-----------+
5 rows in set (0.00 sec)
```
## Запрос с `WHERE`

### 1. Оператор `=`
Этот запрос возвращает все виноградники, расположенные в Бордо. Полезен для фильтрации виноградников по конкретному региону.
```sql
SELECT * FROM Vineyards WHERE location = 'Bordeaux';
+-------------+----------------+----------+--------+-----------+--------------------+-----------+---------------+
| vineyard_id | name           | location | area   | soil_type | grape_variety      | climate   | planting_date |
+-------------+----------------+----------+--------+-----------+--------------------+-----------+---------------+
|           5 | Chteau Margaux | Bordeaux | 300.00 | Gravel    | Cabernet Sauvignon | Temperate | 1995-03-15    |
+-------------+----------------+----------+--------+-----------+--------------------+-----------+---------------+
1 row in set (0.00 sec)
```

### 2. Оператор `BETWEEN`
Этот запрос выбирает все записи о производстве вина в период с 2010 по 2020 год. Полезен для анализа данных о производстве вина за указанный период.
```sql
SELECT * FROM WineProduction WHERE production_date BETWEEN '2010-01-01' AND '2020-12-31';
+---------------+----------+------------------+-----------------+-------------+-----------+----------+
| production_id | batch_id | grape_variety_id | production_date | vineyard_id | wine_type | aging_id |
+---------------+----------+------------------+-----------------+-------------+-----------+----------+
|             5 |      101 |                1 | 2015-08-10      |           1 | Red       |        1 |
|             2 |      102 |                2 | 2017-11-15      |           2 | Red       |        2 |
|             3 |      103 |                1 | 2018-12-20      |           3 | Red       |        1 |
+---------------+----------+------------------+-----------------+-------------+-----------+----------+
3 rows in set (0.00 sec)
```
### 3. Оператор `LIKE`
 Этот запрос ищет все сорта винограда, содержащие в своем имени слово "Cabernet". Полезен для нахождения всех сортов винограда, связанных с Cabernet.
```sql
SELECT * FROM GrapeVarieties WHERE variety_name LIKE '%Cabernet%';
+------------------+--------------------+----------------------+-----------+
| grape_variety_id | variety_name       | optimal_harvest_time | wine_type |
+------------------+--------------------+----------------------+-----------+
|                1 | Cabernet Sauvignon | 2024-09-15           | Red       |
+------------------+--------------------+----------------------+-----------+
1 row in set (0.00 sec)
```
### 4. Оператор `IN`
 Этот запрос возвращает все бочки, сделанные из дуба или каштана. Полезен для анализа бочек по типу древесины.
```sql
SELECT * FROM Barrels WHERE wood_type IN ('Oak', 'Chestnut');
+-----------+--------+-----------+----------+--------------------+------------------+-----------------------+----------+--------------------+----------------------------------------+
| barrel_id | volume | wood_type | capacity | last_cleaning_date | barrel_condition | aging_duration_months | aging_id | barrel_supplier_id | attributes                             |
+-----------+--------+-----------+----------+--------------------+------------------+-----------------------+----------+--------------------+----------------------------------------+
|         2 | 500.00 | Oak       |   400.00 | 2024-01-15         | Good             |                    12 |        1 |                  1 | {"color": "Brown", "origin": "France"} |
|         3 | 500.00 | Oak       |   400.00 | 2024-01-15         | Good             |                    12 |        1 |                  1 | {"color": "Brown", "origin": "France"} |
+-----------+--------+-----------+----------+--------------------+------------------+-----------------------+----------+--------------------+-------------------------------------
```

### 5. Оператор `IS NULL`
Этот запрос выбирает все бутылки, у которых не указан производитель. Полезен для выявления данных, которые могут быть неполными.
```sql
SELECT * FROM Bottles WHERE manufacturer IS NULL;
+-----------+-------+----------+-------+--------------+-----------------+--------------------+---------------+
| bottle_id | size  | material | color | manufacturer | production_date | bottle_supplier_id | production_id |
+-----------+-------+----------+-------+--------------+-----------------+--------------------+---------------+
|         1 | 750ml | Glass    | Green | NULL         | 2015-08-11      |                  1 |             1 |
|         3 | 375ml | Glass    | Green | NULL         | 2018-12-21      |                  3 |             3 |
+-----------+-------+----------+-------+--------------+-----------------+--------------------+---------------+
2 rows in set (0.00 sec
```
